<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>Android动画机制与使用技巧 | 小小黄金屋</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="小小黄金屋">
    <meta name="author" content="Twist Fate">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="小小黄金屋" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    
    

    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- Google Webfonts (Monserrat 400/700, Open Sans 400/600) -->
    <link href='//fonts.useso.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='//fonts.useso.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>

    <!-- Load our fonts individually if IE8+, to avoid faux bold & italic rendering -->
    <!--[if IE]>
    <link href='http://fonts.useso.com/css?family=Montserrat:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:600' rel='stylesheet' type='text/css'>
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->










  
  
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/" target="_BLANK" class="animsition-link">Android</a></li>
                    
                        <li><a href="/atom.xml" target="_BLANK" class="animsition-link">架构</a></li>
                    
                </ul>
            </li>
            
            
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://go.kieran.top/" class="animsition-link">Kieran</a></li>
                    
                    <li><a href="http://domain.com/" class="animsition-link">Name</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">小小黄金屋</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/rainyandsunny/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2017-03-09T07:11:31.000Z" itemprop="datePublished">
          2017-03-09
      </time>
    
</span>
                <h1>Android动画机制与使用技巧</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h2 id="Android-View动画框架"><a href="#Android-View动画框架" class="headerlink" title="Android View动画框架"></a>Android View动画框架</h2><h3 id="透明度动画"><a href="#透明度动画" class="headerlink" title="透明度动画"></a>透明度动画</h3><p>为视图增加透明度的变换动画。</p>
<pre><code>AlphaAnimation aa = new AlphaAnimation(0,1);
aa.setDuration(1000);
view.startAnimation(aa);
</code></pre><h3 id="旋转动画"><a href="#旋转动画" class="headerlink" title="旋转动画"></a>旋转动画</h3><p>为视图增加旋转的变换动画。</p>
<pre><code>RotateAnimation ra = new RotateAnimation(0,360,100,100);
ra.setDurayion(1000);
view.startAnimation(ra);
</code></pre><p>其参数分别为旋转的起始角度和旋转中心点的坐标，当然，可以通过设置参数来控制旋转动画的参考系，代码如下所示（设置旋转参考系为自身中心点）。</p>
<pre><code>RotateAnimation ra = new RotateAnimation(0,360,RotateAnimation.RELATIVE_TO_SELF,0.5F,
RotateAnimation.RELATIVE_TO_SELF,0.5F);
</code></pre><h3 id="位移动画"><a href="#位移动画" class="headerlink" title="位移动画"></a>位移动画</h3><p>为视图移动时增加位移动画。</p>
<pre><code>TranslateAnimation ta = new TranslateAnimation(0,200,0,300);
ta.setDuration(1000);
view.startAnimation(ta);
</code></pre><h3 id="缩放动画"><a href="#缩放动画" class="headerlink" title="缩放动画"></a>缩放动画</h3><p>为视图的缩放增加动画效果</p>
<p>ScaleAnimation sa = new ScaleAnimation(0,2,0,2);<br>sa.setDuration(1000);<br>view.startAnimation(sa);</p>
<p>缩放动画也可以设置缩放的中心点，代码如下：</p>
<pre><code>ScaleAnimation sa = new ScaleAnimation(0,1,0,1,
Animation.RELATIVE_TO_SELF,0.5F,
Animation.RELATIVE_TO_SELF,0.5F);
sa.setDuration(1000);
view.startAnimation(sa);
</code></pre><h3 id="动画集合"><a href="#动画集合" class="headerlink" title="动画集合"></a>动画集合</h3><p>通过AnimationSet，可以将动画以组合的形式展现出来。</p>
<p>对于动画事件，Android也提供了对应的监听回调，要添加对应的监听方法，代码如下：</p>
<pre><code>animation.setAnimationListener(new Animation.AnimationListener(){

@Override
public void onAnimationStart(Animation animation){
}
@Override
public void onAnimationEnd(Animation animation){}

@Override
public void onAnimationRepeat(Animation animation){}

});
</code></pre><h2 id="Android属性动画分析"><a href="#Android属性动画分析" class="headerlink" title="Android属性动画分析"></a>Android属性动画分析</h2><p>Android3.0之前已有的动画框架Animation存在一些局限性——动画改变的只是显示，并不能响应事件。在3.0之后，提出了属性动画这样一个新的动画框架，用来实现更加丰富的动画效果。</p>
<p>在Animation框架中使用最多的就是AnimationSet和ObjectAnimator配合，ObjectAnimator进行更精细化控制，只控制一个对象的一个属性值，而使用多个ObjectAnimator组合到AnimatorSet形成一个动画。而且ObjectAnimator能够自我驱动，可以调用setFrameDelay(long frameDelay)设置动画帧之间的间隙时间、调整帧率，减少动画过程中频繁绘制界面，而在不影响动画效果的前提下减少CPU的资源消耗。</p>
<p>最重要的是，属性动画通过调用属性的get、set方法来真实地控制了一个View的属性值。</p>
<h3 id="ObjectAnimator"><a href="#ObjectAnimator" class="headerlink" title="ObjectAnimator"></a>ObjectAnimator</h3><p>ObjectAnimator是属性动画框架中最重要的实行类，创建一个ObjectAnimator只需要通过静态工厂类直接返回一个ObjectAnimator。参数包括一个对象和对象的属性名字，但这个属性必须有get和set函数，内部会通过Java反射机制来调用set函数修改对象属性值。同样，可以调用setInterpolator设置相应的插值器。</p>
<p>例如：</p>
<pre><code>ObjectAnimator animator = ObjectAnimator.ofFloat(view,&quot;translationX&quot;,300);
</code></pre><p><strong>注意：在使用ObjectAnimator的时候，要注意一点，那就是要操作的属性必须具有get、set方法，不然ObjectAnimator就无法起效。</strong></p>
<p>下面是常用的可以直接使用属性动画的属性值：</p>
<ol>
<li>translationX和translationY：这两个属性作为一种增量来控制着View对象从它布局容器的左上角坐标偏移的位置。</li>
<li>rotation、rotationX和rotationY：这三个属性控制View对象围绕支点进行2D和3D旋转。</li>
<li>scaleX和scaleY：这两个属性控制着View对象围绕它的支点进行2D缩放。</li>
<li>pivotX和pivotY：这两个属性控制着View对象的支点位置，围绕这个支点进行缩放变换处理。默许情况下，该支点的位置就是View对象的中心点。</li>
<li>x和y：这是两个简单实用的属性，它描述了View对象在它的容器中的最终位置，它是最初的左上角坐标和translationX、translationY值的累计和。</li>
<li>alpha：它表示View对象的alpha透明度。默认是1（不透明），0代表完全透明（不可见）。</li>
</ol>
<p>如果一个属性没有get、set方法。可以通过以下两种方法来解决。</p>
<ol>
<li>通过自定义一个属性类或者包装类，来间接地给这个属性增加get、set方法。</li>
<li>通过ValueAnimator来实现。</li>
</ol>
<p>先来看看第一种方法。</p>
<pre><code>private static class WrapperView{

    private View mTarget；

    public WrapperView(View target){
        mTarget = target;
    }

    public int getWidth(){
        return mTarget.getLayoutParams(0/width;
    }

    public void setWidth(int width){
        mTarget.getLayoutParams().width = width;
        mTarget.requestLayout();
    }
}
</code></pre><p>通过以上代码，就给一个属性包装了一层。使用方法如下：</p>
<pre><code>ViewWrapper wrapper = new ViewWrapper(mButton);
ObjectAnimator.ofInt(wrapper,&quot;width&quot;,500).setDuration(5000).start();
</code></pre><h3 id="PropertyValuesHolder"><a href="#PropertyValuesHolder" class="headerlink" title="PropertyValuesHolder"></a>PropertyValuesHolder</h3><p>类似视图动画中的AnimationSet，在属性动画中，如果针对同一个对象的多个属性，要同时作用多种动画，可以使用PropertyValuesHolder来实现。</p>
<pre><code>PropertyValuesHolder pvh1 = PropertyValuesHolder.ofFloat(&quot;translationX&quot;,300f);
PropertyValuesHolder pvh2 = PropertyValuesHolder.ofFloat(&quot;scaleX&quot;,1f,0,1f);
PropertyValuesHolder pvh3 = PropertyValuesHolder.ofFloat(&quot;scaleY&quot;,1f,0,1f);

ObjectAnimator.ofPropertyValuesHolder(view,pvh1,pvh2,pvh3).setDuration(1000).start();
</code></pre><h3 id="ValueAnimator"><a href="#ValueAnimator" class="headerlink" title="ValueAnimator"></a>ValueAnimator</h3><p>ValueAnimator在属性动画中占据着非常重要的地位，是属性动画的核心。ObjectAnimator也是继承自ValueAnimator。</p>
<p>ValueAnimator本身不提供任何动画效果，它更像一个数值发生器，用来产生具有一定规律的数字，从而让调用者来控制动画的实现过程，ValueAnimator的一般使用方法如下所示，通常情况下，在ValueAnimator的AnimatorUpdateListener中监听数值的变换，从而完成变换。</p>
<pre><code>ValueAnimator animator = ValueAnimator.ofFloat(0,100);
   animator.setTarget(mImageView);
   animator.setDuration(1000).start();
   animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener(){

       @Override
       public void onAnimationUpdate(ValueAnimator animation){
           Float value = (Float)animation.getAnimatedValue();
           Log.d(&quot;yhp&quot;,&quot;value:&quot; + value);
       }

   });
</code></pre><h3 id="动画事件的监听"><a href="#动画事件的监听" class="headerlink" title="动画事件的监听"></a>动画事件的监听</h3><p>一个完成的动画具有Start、Repeat、End、Cancel四个过程。</p>
<pre><code> ObjectAnimator anim = ObjectAnimator.ofFloat(mImageView,&quot;alpha&quot;,1f,0.5f);
        anim.addListener(new Animator.AnimatorListener() {
            @Override
            public void onAnimationStart(Animator animation) {

            }

            @Override
            public void onAnimationEnd(Animator animation) {

            }

            @Override
            public void onAnimationCancel(Animator animation) {

            }

            @Override
            public void onAnimationRepeat(Animator animation) {

            }
        });

当然，大部分的时候，只关心onAnimationEnd事件，所以AnimatorListenerAdapter来让我们选择必要的事件进行监听。


anim.addListener(new AnimatorListenerAdapter(){

    @Override
    public void onAnimationEnd(Animator animation){}

});
</code></pre><h3 id="AnimatorSet"><a href="#AnimatorSet" class="headerlink" title="AnimatorSet"></a>AnimatorSet</h3><p>对一个属性同时作用于多个属性动画效果，用PropertyValuesHolder来实现，而AnimatorSet不仅能实现这样的效果，同时也能实现更为精确的顺序控制。</p>
<pre><code>ObjectAnimator animator1 = ObjectAnimator.ofFloat(view,&quot;translationX&quot;,300f);

ObjectAnimator animator2 = ObjectAnimator.ofFloat(view,&quot;scaleX&quot;,1f,0f,1f);

ObjectAnimator animator3 = ObjectAnimator.ofFloat(view,&quot;scaleY&quot;,1f,0f,1f);

AnimatorSet set = new AnimatorSet();
set.setDuration(1000);
set.playTogether(animator1,animator2,animator3);
set.start();
</code></pre><p>通过playTogether()、playSequentially()控制。</p>
<h3 id="在XML中使用属性动画"><a href="#在XML中使用属性动画" class="headerlink" title="在XML中使用属性动画"></a>在XML中使用属性动画</h3><p>例如：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;objectAnimator xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:duration=&quot;1000&quot;
    android:propertyName=&quot;scaleX&quot;
    android:valueFrom=&quot;1.0&quot;
    android:valueTo=&quot;2.0&quot;
    android:valueType=&quot;floatType&quot;
    &gt;

&lt;/objectAnimator&gt;
</code></pre><p>在代码中使用的时候也非常简单：</p>
<pre><code>Animator anim = AnimatorInflater.loadAnimator(this,R.animator.scalex);
anim.setTarget(view);
anim.start();
</code></pre><h3 id="View的animate方法"><a href="#View的animate方法" class="headerlink" title="View的animate方法"></a>View的animate方法</h3><p>在Android 3.0之后，View增加了animate方法来直接驱动属性动画，可以认为是属性动画的一种简写方式。代码如下：</p>
<pre><code>view.animate().alpha(0).y(300).setDuration(300)
               .withStartAction(new Runnable() {
                   @Override
                   public void run() {

                   }
               }).withEndAction(new Runnable() {
           @Override
           public void run() {
               runOnUiThread(new Runnable() {
                   @Override
                   public void run() {

                   }
               });
           }
       });
</code></pre><h2 id="Android布局动画"><a href="#Android布局动画" class="headerlink" title="Android布局动画"></a>Android布局动画</h2><p>所谓布局动画是指作用在ViewGroup上，给ViewGroup增加View时添加一个动画过渡效果。最简单的布局动画是在ViewGroup的XML中，使用如下代码来打开布局动画。</p>
<pre><code>android:animateLayoutChanges=&quot;true&quot;
</code></pre><p>还可以通过使用LayoutAnimationController类来自定义一个子View的过渡效果，代码如下：</p>
<pre><code>LinearLayout ll = （LinearLayout)findViewById(R.id.ll);
//设置过渡动画
ScaleAnimation sa = new ScaleAnimation(0,1,0,1);
sa.setDuration(2000);

//设置布局动画的显示属性
LayoutAnimationController lac = new LayoutAnimationController(sa,0.5F);
lac.setOrder(LayoutAnimationController.ORDER_NORMAL);

//为ViewGroup设置布局动画
ll.setLayoutAnimation(lac);
</code></pre><p>LayoutAnimationController的第一个参数，是需要作用的动画。而第二个参数，则是每个子View显示的delay时间。当delay时间不为0时，可以设置子View显示的顺序。</p>
<pre><code>LayoutAnimationController.ORDER_NORMAL(顺序)
LayoutAnimationController.ORDER_RANDOM(随机)
LayoutAnimationController.ORDER_REVERSE(反序)
</code></pre><h2 id="Interpolators（插值器）"><a href="#Interpolators（插值器）" class="headerlink" title="Interpolators（插值器）"></a>Interpolators（插值器）</h2><p>插值器是动画中一个非常重要的概念，通过插值器，可以定义动画变换速率。</p>
<h2 id="自定义动画"><a href="#自定义动画" class="headerlink" title="自定义动画"></a>自定义动画</h2><p>创建自定义动画很简单，继承Animation。只需要实现它的applyTransformation的逻辑就可以，还需要覆盖父类的initialize方法来实现一些初始化工作。</p>
<pre><code>applyTransformation(float interpolatedTime, Transformation t)
</code></pre><p>第一个参数interpolatedTime就是插值器的时间因子，这个因子是由动画当前完成的百分比和当前时间所对应的插值所计算得来的，取值范围为0~1.0。</p>
<p>第二个参数Transformation，它是矩阵的封装类，一般使用这个矩阵对象，代码如下：</p>
<pre><code>final Matrix matrix = t.getMatrix();
</code></pre><p>通过改变获得的matrix对象，将动画效果实现出来。对于matrix的变换操作，基本可以实现任何效果的动画。</p>
<pre><code>@Override
protected void applyTransformation(){

    final Matrix matrix = t.getMatrix();
    //通过matrix的各种操作来实现动画
    matrix.***;
}
</code></pre><h2 id="Android-5-X-SVG矢量动画机制"><a href="#Android-5-X-SVG矢量动画机制" class="headerlink" title="Android 5.X SVG矢量动画机制"></a>Android 5.X SVG矢量动画机制</h2><p>SVG：</p>
<ol>
<li>可伸缩矢量图形</li>
<li>定义用于网络的基于矢量的图形</li>
<li>使用XML格式定义图形</li>
<li>图形在放大或改变尺寸的情况下其图形质量不会所有损失</li>
</ol>
<p>SVG比Bitmap（位图）的好处：</p>
<p>Bitmap(位图)通过在每个像素点上存储色彩信息来表达图像，而SVG是一个绘图标准。SVG最大的优点就是放大不会失真。而且Bitmap需要为不同分辨率设计许多套图标，而矢量图形则不需要。</p>
<h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a><path></path>标签</h3><p>使用<path></path>创建SVG，<path></path>标签所支持的指令有以下几种。</p>
<p>M = moveto(M X,Y):将画笔移动到指定的坐标位置，但未发生绘制<br>L = lineto（L X,Y):画直线到指定的坐标位置<br>H = horizontal lineto(H X):画水平线到指定的X坐标位置<br>V = vertical lineto(V Y):画垂直线到指定的Y坐标位置<br>C = curveto(C X1,Y1,X2,Y2,ENDX,ENDY): 二次贝赛曲线<br>S = smooth curveto(S X2,Y2,ENDX,ENDY): 三次贝赛曲线<br>Q = quadratic Belzier curve(Q X,Y,ENDX,ENDY):二次贝赛曲线<br>T = smooth quadratic Belzier curveto(T ENDX,ENDY):映射前面路径后的终点<br>A = elliptical Arc(A RX,RY,XROTATION,FLAG1,FLAG2,X,Y):弧线<br>Z = closepath() : 关闭路径</p>
<p>在使用上面的指令时，需要注意以下几点：</p>
<p>坐标轴以（0，0）为中心，X轴水平向右，Y轴水平向下。</p>
<p>所有指令大小写均可。大写绝对定位，参照全局坐标系。小写相对定位，参照父容器坐标系。</p>
<p>指令和数据间的空格可以省略。</p>
<p>同一个指令出现多次可以只用一个。</p>
<h3 id="Android中使用SVG"><a href="#Android中使用SVG" class="headerlink" title="Android中使用SVG"></a>Android中使用SVG</h3><p>在Android 5.X中提供了下面两个新的API来帮助支持SVG：</p>
<p>VectorDrawable （创建基于XML的SVG图）</p>
<p>AnimatedVectorDrawable（实现动画效果）</p>
<h4 id="VectorDrawable"><a href="#VectorDrawable" class="headerlink" title="VectorDrawable"></a>VectorDrawable</h4><p>在XML中创建一个静态的SVG图形。path是SVG树形结构中的最小单位，而通过Group可以将不同的path进行组合。</p>
<pre><code>&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:height=&quot;200dp&quot;
    android:width=&quot;200dp&quot;
    android:viewportHeight=&quot;100&quot;
    android:viewportWidth=&quot;100&quot;
&gt;
&lt;/vector&gt;
</code></pre><p>height,width表示该SVG图形的具体大小，而viewportHeight，viewportWidth表示SVG图形划分的比例。比如上面的代码。将200dp话费为100份，如果在绘制时使用坐标（50，50），则意味着该坐标位于该SVG图形正中间。</p>
<p>所以，width、height的比例与viewportWidth，viewportHeight的比例保持一致，不然图形就会发生压缩，形变。</p>
<p>给<vector>标签增加显示path，代码如下：</vector></p>
<pre><code>&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:height=&quot;200dp&quot;
    android:width=&quot;200dp&quot;
    android:viewportHeight=&quot;100&quot;
    android:viewportWidth=&quot;100&quot;
    &lt;group
        android:name=&quot;test&quot;
        android:rotation=&quot;0&quot;&gt;
        &lt;path
            android:fillColor=&quot;@android:color/holo_blue_light&quot;
            android:pathData=&quot;
                M 25 50
                a 25,25 0 1,0 50,0
            &quot;/&gt;

    &lt;/group&gt;

&lt;/vector&gt;
</code></pre><p>通过添加<group>标签和<path></path>标签来绘制一个SVG图形，其中pathData就是绘制SVG图形所用到的指令。</group></p>
<h4 id="AnimatedVectorDrawable"><a href="#AnimatedVectorDrawable" class="headerlink" title="AnimatedVectorDrawable"></a>AnimatedVectorDrawable</h4><p>AnimatedVectorDrawable的作用就是给VectorDrawable提供动画效果。AnimatedVectorDrawable比喻为一个胶水，通过AnimatedVectorDrawable来连接静态的VectorDrawable和动态的objectAnimator。</p>
<p>AnimatedVectorDrawable的使用通过以下几步：</p>
<ol>
<li>在XML文件中通过<animated-vector>标签来声明对AnimatedVectorDrawable的使用，并指定其作用的path或者group。</animated-vector></li>
</ol>
<p><animated-vector xmlns:android="http://schemas.android.com/apk/res/android" android:drawable="@drawable/vector"><br>    <target android:name="test" android:animation="@anim/anim_path1"></target></animated-vector></p>
<p></p>
<p>对应的vector即为静态的VectorDrawable。</p>
<pre><code>&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:height=&quot;200dp&quot;
    android:width=&quot;200dp&quot;
    android:viewportHeight=&quot;100&quot;
    android:viewportWidth=&quot;100&quot;
    &lt;group
        android:name=&quot;test&quot;
        android:rotation=&quot;0&quot;&gt;
        &lt;path
            android:strokeColor=&quot;@android:color/holo_blue_light&quot;
            android:strokeWidth=&quot;2&quot;
            android:pathData=&quot;
                M 25 50
                a 25,25 0 1,0 50,0
            &quot;/&gt;

    &lt;/group&gt;

&lt;/vector&gt;
</code></pre><p>AnimatedVectorDrawable中指定的target的name属性，必须与VectorDrawable中需要作用的name属性保持一致，这样系统才能找到要实现动画的元素。最后通过AnimatedVectorDrawable中target的animation属性，将一个动画作用到了对应name的元素上，objectAnimator代码如下：</p>
<pre><code>&lt;objectAnimator
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:duration=&quot;4000&quot;
    android:propertyName=&quot;rotation&quot;
    android:valueFrom=&quot;0&quot;
    android:valueTo=&quot;360&quot;
/&gt;
</code></pre><p>对动画效果的实现，通过属性动画来实现的，只是属性捎有不同。</p>
<p>在<group>标签和<path></path>标签中添加了rotation、fillColor、pathData等属性，那么在objectAnimator中就可以通过指定android:propertyName=”XXXX”属性，可以控制动画的起始值。</group></p>
<p><strong>如果指定属性为pathData，那么需要添加一个属性 android:valueType=”pathType”来告诉系统进行pathData变换。</strong></p>
<p>当所有的xml文件准备好了以后，就可以在代码中控制SVG动画，可以非常方便地将一个AnimatedVectorDrawable XML文件设置给一个ImageView作为背景。</p>
<pre><code>&lt;ImageView
    android:id=&quot;@+id/image&quot;
    android:src=&quot;@drawable/anim_vector&quot;
    ......
/&gt;
</code></pre><p>在程序中，使用以下代码，即可开始SVG动画。</p>
<p>((Animatable)imageView.getDrawable()).start();</p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2017/03/13/读书笔记——《Android群英传》第十章/" style="float: left;">
        ← Android性能优化
    </a>
    
    
    <a class="pull-right" href="/2017/03/07/读书笔记——《深入分析Java Web技术内幕》第一章/">
        深入Web请求过程 →
    </a>
    
</nav>

        <div class="duoshuo">
<div class="ds-thread" data-thread-key="2017/03/09/读书笔记——《Android群英传》第七章/" data-title="Android动画机制与使用技巧" data-url="http://yoursite.com/2017/03/09/读书笔记——《Android群英传》第七章/"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"rainyandsunny"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By Twist Fate. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/rainyandsunny/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
